webpackJsonp([1],{"7zck":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("7+uW"),i=n("3EgV"),a=n.n(i),r=(n("7zck"),n("Xxa5")),o=n.n(r),c=n("exGp"),l=n.n(c),d=n("+T3g"),u=n.n(d),p={name:"app",data:function(){return console.log("*"+window.pryvUsername+"*"),{username:window.pryvUsername,state2:"loading"}},computed:{state:function(){return this.state2}},created:function(){var e=this;return l()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return window.pryvApiEndpoint=e.$route.query.pryvApiEndpoint||null,null==window.pryvApiEndpoint&&console.error("pryvApiEndpoint is not set"),n=new u.a.Connection(window.pryvApiEndpoint),window.pryvConnection=n,t.next=6,n.username();case 6:window.pryvUsername=t.sent,e.username=window.pryvUsername,e.state2="ok",console.log("ok",n);case 10:case"end":return t.stop()}},t,e)}))()}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[null==e.username?n("div",[e._v("\n    Missing pryvApiEndpoint\n  ")]):n("div",["loading"==e.state?n("div",[e._v("\n      Loading ...\n    ")]):n("div",["nok"==e.state?n("div",[e._v("\n        Failed\n      ")]):n("div",[e._v("\n        Audit for user: "+e._s(e.username)+"\n        "),n("router-link",{attrs:{to:"./"}},[e._v("Accesses")]),e._v(" "),n("router-view")],1)])])])},staticRenderFns:[]};var m=n("VU/8")(p,f,!1,function(e){n("XYdn")},null,null).exports,v=n("/ocq"),y=n("fTnx"),h=n.n(y),g={};function w(e){return function(t){return"system"===t[e]?"System or Owner":g[t[e]]?g[t[e]].name:g[t[e]]}}var k,_=[{key:"lastUsed",title:"Last Usage",display:(k="lastUsed",function(e){return new Date(1e3*e[k]).toLocaleString()})},{key:"name",title:"Name",display:function(e){return function(t){return t[e]}}("name")},{key:"type",title:"Type",display:function(e){return"shared"===e.type?"Sharing":"app"===e.type?e.name.startsWith("cm-")?"Consent":"Device & App":"personal"==e.type?"Management tools":"Unknown"}},{key:"deleted",title:"Status",display:function(e){return null!=e.deleted?"Deleted":null!=e.expires&&new Date(1e3*e.expires)<new Date?"Expired":"Valid"}}],b=null,x={name:"Accesses",props:["onSelectProp"],data:function(){return{search:"",username:window.pryvUsername,UserInput:"",accesses:this.accesses,fields:_,pagination:{sortBy:"lastUsed",descending:!0,rowsPerPage:10},selected:[]}},computed:{},created:function(){var e=this;return l()(o.a.mark(function t(){var n,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.connection=window.pryvConnection,n=void 0,t.prev=2,t.next=5,e.connection.get("accesses");case 5:n=t.sent,t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(2),console.log(t.t0),t.abrupt("return");case 12:console.log("Access",n),s=n.accesses||[],null!=n.accessDeletions&&(s=s.concat(n.accessDeletions)),e.accesses=s,e.accesses.forEach(function(e){g[e.id]=e});case 17:case"end":return t.stop()}},t,e,[[2,8]])}))()},methods:{filteredAccesses:function(){var e=this;return null!=this.search&&""!=this.search?this.accesses.filter(function(t){return t.id.includes(e.search)}):this.accesses},GoToRoute:function(){this.$router.push({name:"Paramdetails",params:{id:this.UserInput}})},changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},onSelect:function(e){e!==b&&(e.createdByName=w("createdBy")(e),e.modifiedByName=w("modifiedBy")(e),b=e,this.onSelectProp&&this.onSelectProp(b),console.log("Accesses selected "+e.name+" > "+e.id))}}},A={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.fields,items:e.filteredAccesses(),pagination:e.pagination,"select-all":"","item-key":"id"},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"headers",fn:function(t){return[e._e(),e._v(" "),n("tr",e._l(t.headers,function(t){return n("th",{key:t.key,class:["column sortable",e.pagination.descending?"desc":"asc",t.name===e.pagination.sortBy?"active":""],on:{click:function(n){e.changeSort(t.key)}}},[n("v-icon",{attrs:{small:""}},[e._v("arrow_upward")]),e._v("\n        "+e._s(t.title)+"\n      ")],1)}))]}},{key:"items",fn:function(t){return[n("tr",{attrs:{active:t.selected},on:{click:function(n){e.onSelect(t.item)}}},e._l(e.fields,function(s){return n("td",{staticClass:"text-xs-left"},[e._v("\n        "+e._s(s.display(t.item))+"\n      ")])}))]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})},staticRenderFns:[]},S=n("VU/8")(x,A,!1,null,null,null).exports,L=n("EFqf"),D=n.n(L),B=n("fZjL"),P=n.n(B),U=n("BO1k"),C=n.n(U),E=n("woOf"),j=n.n(E);n("0rCA");var M=[{key:"time",title:"Date",display:function(e){return new Date(1e3*e.time).toLocaleString()}},{key:"action",title:"Action",display:function(e){return e.content&&e.content.action||e.action}},{key:"source",title:"Source",display:function(e){return e.content&&e.content.source||e.forwardedFor}}],R=[{title:"query",key:"query",display:function(e){return e.content&&e.content.query}},{title:"Others",key:"others",display:function(e){var t=j()({},e);j()(t,e.content),delete t.content,delete t.time,delete t.created,delete t.modified,delete t.modifiedBy,delete t.streamIds,delete t.query,delete t.action,delete t.source;var n="",s=!0,i=!1,a=void 0;try{for(var r,o=C()(P()(t));!(s=(r=o.next()).done);s=!0){var c=r.value;n+="<BR>&nbsp;<B>"+c+": </B>"+t[c]}}catch(e){i=!0,a=e}finally{try{!s&&o.return&&o.return()}finally{if(i)throw a}}return n}}],V=null,F={name:"auditLogs",properties:["onSelectProp"],props:{auditLogs:{type:Array,default:[]}},data:function(){return{username:window.pryvUsername,UserInput:"",fields:M,details:R,pagination:{sortBy:"time",descending:!0,rowsPerPage:9},selected:[]}},computed:{},created:function(){},methods:{changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},onSelect:function(e){e!==V&&(V=e,this.onSelectProp&&this.onSelectProp(V),console.log("audit log selected "+e.id))}}},$={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.fields,items:e.auditLogs,pagination:e.pagination,"select-all":"","item-key":"id"},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"headers",fn:function(t){return[n("tr",e._l(t.headers,function(t){return n("th",{key:t.key,class:["column sortable",e.pagination.descending?"desc":"asc",t.name===e.pagination.sortBy?"active":""],on:{click:function(n){e.changeSort(t.key)}}},[n("v-icon",{attrs:{small:""}},[e._v("arrow_upward")]),e._v("\n        "+e._s(t.title)+"\n      ")],1)}))]}},{key:"items",fn:function(t){return[n("tr",{attrs:{active:t.selected},on:{click:function(n){t.expanded=!t.expanded,e.onSelect(t.item)}}},e._l(e.fields,function(s){return n("td",{staticClass:"text-xs-left"},[e._v("\n        "+e._s(s.display(t.item))+"\n      ")])}))]}},{key:"expand",fn:function(t){return[n("v-card",{attrs:{flat:""}},[n("v-card-text"),e._v(" "),e._l(e.details,function(s){return n("ul",[s.display(t.item)?n("li",{staticClass:"grey--text",staticStyle:{"white-space":"nowrap","text-align":"left"}},[n("B",[e._v(e._s(s.title))]),e._v(" — "),n("span",{domProps:{innerHTML:e._s(s.display(t.item))}})],1):e._e()])}),e._v(" "),n("v-card-text")],2)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})},staticRenderFns:[]},q=n("VU/8")(F,$,!1,null,null,null).exports,z=[{key:"permission",title:"Permissions",display:function(e){return"personal"===e.type?"System or Owner":e.permissions}},{key:"clientData",title:"Informations",display:function(e){if(e.clientData)return e.clientData["app-web-auth:description"]?D()(e.clientData["app-web-auth:description"].content):D()(e.clientData);return"-"}},{key:"created",title:"Creation Date",display:N("created")},{key:"createdBy",title:"Created By",display:I("createdByName")},{key:"modified",title:"Modification Date",display:function(e){return e.modified!==e.created?N("modified")(e):"-"}},{key:"modifiedBy",title:"Modified By",display:I("modifiedByName")},{key:"deleted",title:"Deleted",display:N("deleted")},{key:"expires",title:"Expires",display:N("expires")}];function N(e){return function(t){return null==t[e]?"-":new Date(1e3*t[e]).toLocaleString()}}function I(e){return function(t){return t[e]||"-"}}var O={name:"Data",props:[],components:{Audit:q},data:function(){return{auditLogs:[],auditLogsMap:{},access:this.selectedAccess,connection:this.connection,state:"loading",details:z}},computed:{},created:function(){var e=this;return l()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.access=null,e.connection=window.pryvConnection,e.state="ok";case 3:case"end":return t.stop()}},t,e)}))()},methods:{selectAccess:function(){var e=l()(o.a.mark(function e(t){var n,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Data selected Access:"+t.name),this.access=t,null!=this.access&&null!=this.auditLogsMap){e.next=4;break}return e.abrupt("return",this.auditLogs=[]);case 4:if(null==this.auditLogsMap[t.id]){e.next=6;break}return e.abrupt("return",this.auditLogs=this.auditLogsMap[t.id]);case 6:return this.state="loading",this.connection=window.pryvConnection,n=void 0,e.prev=9,e.next=12,this.connection.getRaw("audit/logs",{accessId:t.id});case 12:n=e.sent,e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(9),console.log(e.t0),this.state="nok",e.abrupt("return");case 20:s=n.body.auditLogs,console.log("Audit data:",s),this.auditLogsMap[t.id]=s,this.auditLogs=s,this.state="ok";case 25:case"end":return e.stop()}},e,this,[[9,15]])}));return function(t){return e.apply(this,arguments)}}()}},T={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"data"}},["loading"==e.state?n("div",[e._v("\n    Loading ...\n  ")]):n("div",["nok"==e.state?n("div",[e._v("\n      Failed\n    ")]):n("div",[e._v("\n      Details\n      "),e.access?n("div",[n("div",{staticClass:"headline"},[e._v(e._s(e.access.name))]),e._v(" "),e._l(e.details,function(t){return n("ul",["-"!==t.display(e.access)?n("li",{staticClass:"grey--text",staticStyle:{"white-space":"nowrap","text-align":"center"}},[n("B",[e._v(e._s(t.title))]),e._v(" — "),n("span",{domProps:{innerHTML:e._s(t.display(e.access))}})],1):e._e()])})],2):n("div",[n("H3",[e._v("-")])],1),e._v(" "),n("Audit",{attrs:{auditLogs:e.auditLogs}})],1)])])},staticRenderFns:[]},H=n("VU/8")(O,T,!1,null,null,null).exports,G={name:"main",components:{Accesses:S,splitPane:h.a,Data:H},methods:{onEventLoaded:function(){},onAccessSelect:function(e){console.log("*****",e),this.$refs.dataView.selectAccess(e)},resize:function(){console.log("resize")}}},J={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"mainView"}},[t("split-pane",{attrs:{"min-percent":50,"default-percent":50,split:"vertical"},on:{resize:this.resize}},[t("template",{slot:"paneL"},[t("Accesses",{attrs:{onSelectProp:this.onAccessSelect}})],1),this._v(" "),t("template",{slot:"paneR"},[t("Data",{ref:"dataView"})],1)],2)],1)},staticRenderFns:[]};var X=n("VU/8")(G,J,!1,function(e){n("cgRD")},null,null).exports;s.default.use(a.a),s.default.use(v.a);var W=[{path:"/",component:X}],Y=new v.a({base:window.location.pathname,routes:W,mode:"hash"});window.v=new s.default({el:"#app",template:"<App/>",components:{App:m},router:Y}).$mount("#app")},XYdn:function(e,t){},cgRD:function(e,t){},kGJU:function(e,t){e.exports={name:"pryv",version:"2.1.7",homepage:"https://github.com/pryv/lib-js",description:"Pryv Javascript Library",keywords:["Pryv"],repository:{type:"git",url:"git://github.com/pryv/lib-js"},bugs:{url:"https://github.com/pryv/lib-js/issues"},author:{name:"Pryv S.A."},main:"src/index.js",license:"BSD-3-Clause",scripts:{setup:"./scripts/setup-environment-dev.sh",build:"webpack --config webpack.config.js",doc:"node node_modules/jsdoc/jsdoc.js -c .jsdoc-conf.json",test:"mocha --reporter spec  test/**/*.test.js --timeout 3000","test-debug":"mocha --inpect-brk=40000 --reporter spec  test/**/*.test.js ","test:browser":"npm run build; ",cover:"nyc npm run test && npm run cover:report","cover:report":"nyc report --reporter=lcov --reporter=html",webserver:"./node_modules/.bin/rec-la ./dist 9443","gh-pages":"./scripts/upload.sh",clear:"rm -r dist/ && npm run setup"},contributors:[{name:"Pierre-Mikael Legris",email:"perki@pryv.com"}],dependencies:{superagent:"^5.2.2"},devDependencies:{"@pryv/lib-js-common":"git+https://github.com/pryv/lib-js-common.git#1.0.4","@pryv/monitor":"^1.0.5","@pryv/socket.io":"^1.0.5",chai:"^4.2.0","chai-as-promised":"^7.1.1",cuid:"^2.1.8",mocha:"^6.2.3","node-fetch":"^2.6.0",nyc:"^14.1.1","rec-la":"latest","universal-url":"^2.0.0",zombie:"^6.1.4"}}}},["NHnr"]);
//# sourceMappingURL=app.a457f05b631150414853.js.map